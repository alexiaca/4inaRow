/*
* grrd's 4 in a Row
* Copyright (c) 2012 Gerard Tyedmers, grrd@gmx.net
* Licensed under the MPL License
*/

!function(){"use strict";window.requestAnimFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)};var e,a,l,t=!1,r=!1,i=["col0","col1","col2","col3","col4","col5","col6"],n=[],c=[],s=[];for(e=0;e<6;e+=1)s[e]=[],s[e][6]=void 0;var d,m,g,u,o,p,h,y,f,_,w,v,b,I,P,S,L,E,M,k,B,C,D,x,T,F,H,R,q,A,N,O,j,W,z,U,G,Q,X=[],J=[],K=null,V=!0,Y=!1,Z=!1,ee=$("#inputImage"),te=$("#inputName"),ne=$("#img_title"),oe=$("#b_sound"),ae=$("#l_country"),le=$("#txt_search"),re=[],ie=[],ce=["#ff0080","#6969EE"],se=["#D6016B","#5A5ACE"],de=["#FD6BB4","#9393EF"],me=0,ge=["Images/red_on.png","Images/red_off.png"],ue=["Images/blue_on.png","Images/blue_off.png"],pe=0,he=[0,0],ye=Boolean(!1),fe=null,_e=0,$e=!1,we=!1,ve=function(){var e="modernizr";try{return localStorage.setItem(e,e),localStorage.removeItem(e),!0}catch(e){return!1}}();function be(e,t,n,o){c[t].beginPath(),c[t].arc(E/2,e,E/2*.85,0,2*Math.PI,!1),c[t].fillStyle=n,c[t].fill(),c[t].lineWidth=E/20,c[t].strokeStyle=o,c[t].stroke()}function Ie(){var e,t,n;a=$(window).height(),(l=$(window).width())<a?(E=Math.min((l-50)/7,(a-140)/6),M=Math.max(6*E*.85,a-190),ne.attr("style","width:100%;"),$(".li_port").attr("style","height:"+(a-l/3-130)/7+"px;"),$(".li_pad").attr("style","padding-top:"+(a-l/3-270)/14+"px;"),$("#page_landscape").attr("style","display:none;"),$("#page_portrait").attr("style","display:inline;"),$("#indicator_landscape_l").attr("style","display:none;"),$("#indicator_landscape_r").attr("style","display:none;"),$("#indicator_portrait").attr("style","display:block;"),$("#popupDialog_landscape").attr("style","display:none;"),$("#popupDialog_portrait").attr("style","display:block;"),$("#popupSettings_portrait").attr("style","display:block;"),$("#popupSettings_landscape").attr("style","display:none;"),$("#popupSettings_col_b").appendTo("#popupSettings_portrait"),$("#printMessage").attr("style","display:block;")):(E=Math.min((l-140-60)/7,(a-20)/6),M=Math.max(6*E*.85,a-95),ne.attr("style","width:"+.6*l+"px;"),$("#blank_space").attr("style","height:"+(a/4-l/20)+"px;"),$("#page_landscape").attr("style","display:inline;"),$("#page_portrait").attr("style","display:none;"),$("#indicator_landscape_l").attr("style","display:inline;"),$("#indicator_landscape_r").attr("style","display:inline;"),$("#indicator_portrait").attr("style","display:none;"),$("#popupDialog_landscape").attr("style","display:block;"),$("#popupDialog_portrait").attr("style","display:none;"),$("#popupSettings_portrait").attr("style","display:none;"),$("#popupSettings_landscape").attr("style","display:block;"),$("#popupSettings_col_b").appendTo("#popupSettings_landscape_b"),$("#printMessage").attr("style","display:inline;"));var o=Math.max((a-l/3)/7,0);for($(".a_land").attr("style","width:"+(l/5-8)+"px;padding-bottom:"+o/2+"px;"),$(".img_land").attr("style","padding-top:"+o+"px;padding-bottom:"+o/2+"px;width: 100%;min-width: 40px;max-width: 108px;"),e=0;e<i.length;e+=1)document.getElementById(i[e]).width=E,document.getElementById(i[e]).height=M;for(t=0;t<s[0].length&&void 0!==c[t];t+=1)for(e=0;e<s.length;e+=1)(n=c[t].createLinearGradient(0,.9*(s.length-e-1)*E,.7*E,.9*(s.length-e-1)*E+.7*E)).addColorStop(0,"black"),n.addColorStop(1,"grey"),c[t].beginPath(),c[t].arc(E/2,(s.length-e-.5)*E*.85,E/2*.7,0,2*Math.PI,!1),c[t].lineWidth=E/10,c[t].strokeStyle=n,c[t].stroke();for(t=0;t<s[0].length&&void 0!==c[t];t+=1){for(c[t].save(),c[t].beginPath(),e=0;e<s.length;e+=1)c[t].arc(E/2,(s.length-e-.5)*E*.85,E/2*.7,0,2*Math.PI,!1);c[t].clip(),c[t].clearRect(0,0,E,M)}for(e=0;e<s.length;e+=1)for(t=0;t<s[e].length;t+=1)void 0!==s[e][t]&&be((s.length-e-.5)*E*.85,t,ce[s[e][t]],se[s[e][t]]);r&&(L=L/S*((s.length-w-.5)*E*.85),S=(s.length-w-.5)*E*.85)}function Pe(){var e,t;for(fe=null,e=_e=0;e<s.length;e+=1)for(t=0;t<s[e].length;t+=1)s[e][t]=void 0,0===e&&c[t].clearRect(0,0,E,M);Ie()}function Se(){$(".P1light").attr("src",ge[me]),$(".P2light").attr("src",ue[1-me])}function Le(){var e,t;ve?(e=parseInt(localStorage.getItem(K+"_win")||0),t=parseInt(localStorage.getItem(K+"_loose")||0)):t=e=0,"online"===K?(k=Math.max(e+t,q+A,1),$(".P"+(1+parseInt(O.role))+".win").width(100/k*e+"%"),$(".P"+(1+parseInt(O.role))+".loose").width(100/k*t+"%"),$(".P"+(2-parseInt(O.role))+".win").width(100/k*q+"%"),$(".P"+(2-parseInt(O.role))+".loose").width(100/k*A+"%")):("2player"===K&&(e=he[0],t=he[1]),k=Math.max(e+t,1),$(".P1.win").width(100/k*e+"%"),$(".P1.loose").width(100/k*t+"%"),$(".P2.win").width(100/k*t+"%"),$(".P2.loose").width(100/k*e+"%"))}function Ee(e){var t,n;ve&&(K&&e&&(t=K+"_"+e,n=parseInt(localStorage.getItem(t)||0)+1,localStorage.setItem(t,n)),D=localStorage.getItem("easy_win")||0,x=localStorage.getItem("easy_loose")||0,T=localStorage.getItem("medium_win")||0,F=localStorage.getItem("medium_loose")||0,H=localStorage.getItem("hard_win")||0,R=localStorage.getItem("hard_loose")||0,B=localStorage.getItem("online_win")||0,C=localStorage.getItem("online_loose")||0,k=Math.max(D,x,T,F,H,R,B,C,1),document.getElementById("easy_win").innerHTML=document.webL10n.get("lb_won")+" "+D,document.getElementById("easy_loose").innerHTML=document.webL10n.get("lb_lost")+" "+x,document.getElementById("medium_win").innerHTML=document.webL10n.get("lb_won")+" "+T,document.getElementById("medium_loose").innerHTML=document.webL10n.get("lb_lost")+" "+F,document.getElementById("hard_win").innerHTML=document.webL10n.get("lb_won")+" "+H,document.getElementById("hard_loose").innerHTML=document.webL10n.get("lb_lost")+" "+R,document.getElementById("online_win").innerHTML=document.webL10n.get("lb_won")+" "+B,document.getElementById("online_loose").innerHTML=document.webL10n.get("lb_lost")+" "+C,document.getElementById("easy_win").style.width=100/k*D+"%",document.getElementById("easy_loose").style.width=100/k*x+"%",document.getElementById("medium_win").style.width=100/k*T+"%",document.getElementById("medium_loose").style.width=100/k*F+"%",document.getElementById("hard_win").style.width=100/k*H+"%",document.getElementById("hard_loose").style.width=100/k*R+"%",document.getElementById("online_win").style.width=100/k*B+"%",document.getElementById("online_loose").style.width=100/k*C+"%")}function Me(e,t){$e||(t+2e3>Date.now()&&r?window.requestAnimFrame(function(){Me(e,t)}):(pe+=1,$("#printMessage").html(e),1===pe?$("#printGames").html(pe+" "+document.webL10n.get("lb_game")):$("#printGames").html(pe+" "+document.webL10n.get("lb_games")),$("#printScore1a").html(h),$("#printScore2a").html(y),$("#printScore1b").html(he[0]),$("#printScore2b").html(he[1]),$.mobile.changePage("#popupDialog",{transition:"pop",role:"dialog"}),Pe(),me=pe%2!=0?1:0,Se(),r=!1))}function ke(){r=!0,function e(t,n,o,a){var l;if(!$e)if(o<6&&a+250<Date.now()&&r){for(o+=1,a=Date.now(),l=0;l<4;l+=1)be((s.length-t[l]-.5)*E*.85,n[l],o%2!=0?de[me]:ce[me],"white");window.requestAnimFrame(function(){e(t,n,o,a)})}else o<6&&r&&window.requestAnimFrame(function(){e(t,n,o,a)})}(X.slice(),J.slice(),0,Date.now())}function Be(e,t,n,o,a,l){var r;if(e+3*n<s.length&&t+3*o<s[e].length&&0<=e+3*n&&0<=t+3*o)for(r=0;r<4;r+=1)s[e+r*n][t+r*o]===a?(X[r]=e+r*n,J[r]=t+r*o,3===r&&(I=!0,l&&ke(),r=5)):r=5}function Ce(e,t){for(I=!1,w=0;w<s.length;w+=1)for(_=0;_<s[w].length;_+=1)Be(w,_,1,0,e,t),Be(w,_,0,1,e,t),Be(w,_,1,1,e,t),Be(w,_,1,-1,e,t);for(P=!1,_=0;_<s[0].length;_+=1)void 0===s[s.length-1][_]&&(P=!0)}function De(e,t,n){var o,a;r&&(o=(new Date).getTime(),a=M*(o-e)/1e3,t<S?(t=Math.min(S,t+a),e=o,c[n].clearRect(0,0,E,S+E/2*.85),be(t,n,ce[me],se[me]),window.requestAnimFrame(function(){De(e,t,n)})):(V&&document.getElementById("click_sound").play(),Ce(me,!(r=!1)),I?(he[me]=he[me]+1,"easy"!==K&&"medium"!==K&&"hard"!==K||Ee(0===me?"win":"loose"),"online"===K&&(0===me&&"0"===O.role||1===me&&"1"===O.role?(A+=1,Ee("win")):(q+=1,Ee("loose"))),Le(),V&&document.getElementById("ding_sound").play(),Me(0===me?h+" "+document.webL10n.get("lb_win"):y+" "+document.webL10n.get("lb_win"),Date.now())):P?(me=1-me,Se(),"2player"!==K&&"online"!==K&&1===me&&Re()):(Ee("draw"),Me(document.webL10n.get("lb_draw"),Date.now()))))}function xe(e){if(!(we&&(we=!1,"online"===K&&(0===me&&"0"===O.role||1===me&&"1"===O.role))||r))for(_e+=1,S=w=0;w<s.length&&0===S;){if(void 0===s[w][e]){r=!0,s[w][e]=me,S=(s.length-w-.5)*E*.85,De((new Date).getTime(),L=-30,e);break}w+=1}}function Te(){Y?$(".P1icon").attr("src",ee.attr("src")):$(".P1icon").attr("src","Images/player.svg"),h=Z?te.val():document.webL10n.get("lb_player"),o?($("p.P1country").html(document.getElementById("l_country").getElementsByClassName(o)[0].innerHTML),$(".P1country").attr("class","P1country "+o)):($("p.P1country").html(" "),$(".P1country").attr("class","P1country")),$("div.P1country").addClass("flag_left"),y=document.webL10n.get("lb_computer"),$(".P1name").html(h),$(".P2name").html(y),$(".P2icon").attr("src","Images/computer.svg"),$("p.P2country").html(" "),$(".P2country").attr("class","P2country"),$("div.P2country").addClass("flag_right"),Le(),Se(),$e=!1,$.mobile.changePage("#game",{transition:"slide"})}function Fe(e,t,n){var o,a;for(g=m=d=0,o=n-3;o<=n;o+=1)if(0<=o&&o+3<s[0].length){for(ye=!0,a=u=0;a<=3;a+=1)void 0!==s[t][o+a]&&(s[t][o+a]===e?u+=1:ye=!1);ye&&(d+=1,m+=u,g<u&&(g=u))}for(o=t+3;t<=o;o-=1)if(0<=o-3&&o<s.length){for(ye=!0,a=u=0;a<=3;a+=1)void 0!==s[o-a][n]&&(s[o-a][n]===e?u+=1:ye=!1);ye&&(d+=1,m+=u,g<u&&(g=u))}for(o=3;0<=o;o-=1)if(0<=n-o&&n-o+3<s[0].length&&0<=t-o&&t-o+3<s.length){for(ye=!0,a=u=0;a<=3;a+=1)void 0!==s[t-o+a][n-o+a]&&(s[t-o+a][n-o+a]===e?u+=1:ye=!1);ye&&(d+=1,m+=u,g<u&&(g=u))}for(o=3;0<=o;o-=1)if(0<=n-o&&n-o+3<s[0].length&&t+o<s.length&&0<=t+o-3){for(ye=!0,a=u=0;a<=3;a+=1)void 0!==s[t+o-a][n-o+a]&&(s[t+o-a][n-o+a]===e?u+=1:ye=!1);ye&&(d+=1,m+=u,g<u&&(g=u))}}function He(e,t){return e-t}function Re(){var e;for(!(re=[]),v=0;v<s[0].length;v+=1)for(re[v]=0,b=0;b<s.length;b+=1)if(void 0===s[b][v]){Fe(s[b][v]=me,b,v),re[v]=1e4*g+100*d+m+2,s[b][v]=void 0;break}for(e=ie[0]=0;e<re.length;e+=1)re[e]>ie[0]&&(ie[0]=re[e]);for(me=1-me,v=0;v<s[0].length;v+=1)for(b=0;b<s.length;b+=1)if(void 0===s[b][v]){Fe(s[b][v]=me,b,v),1e4*g+100*d+m+2>ie[0]&&(re[v]=1e4*g+100*d+m+2),s[b][v]=void 0;break}for(me=1-(me=1-me),v=0;v<s[0].length;v+=1){for(b=0;b<s.length-1;b+=1)if(void 0===s[b][v]){Ce(s[b+1][v]=me,!1),s[b+1][v]=void 0;break}I&&(re[v]=1,I=!1)}for(me=1-(me=1-me),v=0;v<s[0].length;v+=1){for(b=0;b<s.length;b+=1)if(void 0===s[b][v]){Ce(s[b][v]=me,!1),s[b][v]=void 0;break}I&&(re[v]=5e4,I=!1)}for(me=1-me,v=0;v<s[0].length;v+=1){for(b=0;b<s.length;b+=1)if(void 0===s[b][v]){Ce(s[b][v]=me,!1),s[b][v]=void 0;break}I&&(re[v]=6e4,I=!1)}if((ie=re.slice()).sort(He),ie.reverse(),_=Math.round(6*Math.random()),"hard"===K)for(;re[_]!==ie[0];)_=Math.round(6*Math.random());if("medium"===K)for(;re[_]<ie[1]||0===re[_];)_=Math.round(6*Math.random());if("easy"===K)for(;re[_]<ie[2]||0===re[_];)_=Math.round(6*Math.random());xe(_)}function qe(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(window.location.href);return null!==t&&t[1]}function Ae(t){var e=new FileReader,n=document.createElement("canvas"),o=null,a=new Image,l=67,r=71,i={Orientation:void 0};n.id="hiddenCanvas",n.width=l,n.height=r,n.style.visibility="hidden",document.body.appendChild(n),o=n.getContext("2d"),t.target.files[0].type.match("image.*")?e.readAsDataURL(t.target.files[0]):alert("File is not an image"),e.onload=function(){var e=this.result;EXIF.getData(t.target.files[0],function(){i.Orientation=EXIF.getTag(this,"Orientation"),a.src=e})},a.onload=function(){var e=0,t=0;0===this.width||0===this.height?alert("Image is empty"):(5!==i.Orientation&&6!==i.Orientation||(o.rotate(90*Math.PI/180),t=-1*l,l=71,r=67),3!==i.Orientation&&4!==i.Orientation||(o.rotate(180*Math.PI/180),t=-1*l-4,e=-1*r+4),7!==i.Orientation&&8!==i.Orientation||(o.rotate(270*Math.PI/180),e=-1*r,l=71,r=67),o.clearRect(0,0,l,r),o.drawImage(a,0,0,this.width,this.height,e,t,l,r),ee.attr("src",n.toDataURL("image/jpeg")),$("#inputImage_l").attr("src",n.toDataURL("image/jpeg")),ve&&localStorage.setItem("s_image",n.toDataURL("image/jpeg")),Y=!0)}}function Ne(o){ae.find("li").each(function(e,t){var n=$(t);-1<n[0].innerHTML.toLowerCase().indexOf(o)||0===o.length?n.show():n.hide()})}"serviceWorker"in navigator&&window.addEventListener("load",function(){navigator.serviceWorker.register("sw.js").then(function(e){console.log("ServiceWorker registration successful with scope: ",e.scope)},function(e){console.log("ServiceWorker registration failed: ",e)})}),navigator.onLine||$(".bt_online").addClass("ui-disabled"),window.onload=function(){var e;if(ve&&null!==localStorage.getItem("s_sound")?oe.val(localStorage.getItem("s_sound")):oe.val("on"),V="on"===oe.val(),ve&&null!==localStorage.getItem("s_image")&&(ee.attr("src",localStorage.getItem("s_image")),$("#inputImage_l").attr("src",localStorage.getItem("s_image")),Y=!0),ve&&null!==localStorage.getItem("s_name")&&(te.val(localStorage.getItem("s_name")),""!==localStorage.getItem("s_name").replace(/\s+/g,"")&&(Z=!0)),ve&&null!==localStorage.getItem("s_country")){$("#bt_country").empty(),o=localStorage.getItem("s_country");var t=document.getElementsByClassName(o);document.getElementById("bt_country").appendChild(t[0].cloneNode(!0))}for(f=qe("theme"),$(".bt_play").click(function(e){K="2player",Y?$(".P1icon").attr("src",ee.attr("src")):$(".P1icon").attr("src","Images/player.svg"),h=Z?te.val():document.webL10n.get("lb_player1"),o?($("p.P1country").html(document.getElementById("l_country").getElementsByClassName(o)[0].innerHTML),$(".P1country").attr("class","P1country "+o)):($("p.P1country").html(" "),$(".P1country").attr("class","P1country")),$("div.P1country").addClass("flag_left"),y=document.webL10n.get("lb_player2"),$(".P1name").html(h),$(".P2name").html(y),$(".P2icon").attr("src","Images/player.svg"),$(".P2country").attr("class","P2country"),$("p.P2country").html(" "),$("div.P2country").addClass("flag_right"),Se(),Le(),$e=!1,$.mobile.changePage("#game",{transition:"slide"}),e.preventDefault()}),$(".bt_online").click(function(e){$.mobile.changePage("#popupOnline",{transition:"pop",role:"dialog"}),$(".bt_online").addClass("ui-disabled"),(N=io.connect("https://grrd.a2hosted.com:49152",{forceNew:!0})).heartbeatTimeout=2e4,N.on("connect",function(){}),N.on("startgame",function(e){A=q=0,(O=e).id!==j&&(p=Y?ee.attr("src"):null,N.emit("usersend",{to:O.opponent,name:te.val(),pic:p,country:o,win:B,loose:C}),j=O.id,$e=!1,null!==K&&$.mobile.changePage("#title",{transition:"slide",reverse:!0}),r=!1,Pe(),he=[me=pe=0,0],K="online",Se(),Le(),"0"===O.role?(Y?$(".P1icon").attr("src",ee.attr("src")):$(".P1icon").attr("src","Images/player.svg"),h=Z?te.val():document.webL10n.get("lb_player1"),o?($("p.P1country").html(document.getElementById("l_country").getElementsByClassName(o)[0].innerHTML),$(".P1country").attr("class","P1country "+o)):($("p.P1country").html(" "),$(".P1country").attr("class","P1country")),$("div.P1country").addClass("flag_left"),$(".P2icon").attr("src","Images/online.svg"),y=document.webL10n.get("bt_online")):($(".P1icon").attr("src","Images/online.svg"),h=document.webL10n.get("bt_online"),Y?$(".P2icon").attr("src",ee.attr("src")):$(".P2icon").attr("src","Images/player.svg"),y=Z?te.val():document.webL10n.get("lb_player1"),o?($("p.P2country").html(document.getElementById("l_country").getElementsByClassName(o)[0].innerHTML),$(".P2country").attr("class","P2country "+o)):($("p.P2country").html(" "),$(".P2country").attr("class","P2country")),$("div.P2country").addClass("flag_right")),$(".P1name").html(h),$(".P2name").html(y),$.mobile.changePage("#game",{transition:"slide"}))}),N.on("playget",function(e){_e===e.round&&fe!==e.round&&(fe=e.round,we=!0,xe(e.col))}),N.on("userget",function(e){q=parseInt(e.win),A=parseInt(e.loose),k=Math.max(B,C,q,A,1),"0"===O.role?(null!==e.pic&&$(".P2icon").attr("src",e.pic),0<e.name.length&&(y=e.name,$(".P2name").html(y)),e.country?($("p.P2country").html(document.getElementById("l_country").getElementsByClassName(e.country)[0].innerHTML),$(".P2country").attr("class","P2country "+e.country)):($("p.P2country").html(" "),$(".P2country").attr("class","P2country")),$("div.P2country").addClass("flag_right")):(null!==e.pic&&$(".P1icon").attr("src",e.pic),0<e.name.length&&(h=e.name,$(".P1name").html(h)),e.country?($("p.P1country").html(document.getElementById("l_country").getElementsByClassName(e.country)[0].innerHTML),$(".P1country").attr("class","P1country "+e.country)):($("p.P1country").html(" "),$(".P1country").attr("class","P1country")),$("div.P1country").addClass("flag_left")),Le()}),N.on("quit",function(){O.id!==W&&(W=O.id,$e=!0,$.mobile.changePage("#popupLeft",{transition:"pop",role:"dialog"}))}),e.preventDefault()}),$(".bt_easy").click(function(e){K="easy",Te(),e.preventDefault()}),$(".bt_med").click(function(e){K="medium",Te(),e.preventDefault()}),$(".bt_hard").click(function(e){K="hard",Te(),e.preventDefault()}),$(".back").click(function(e){"online"===K&&(N.disconnect(),$(".bt_online").removeClass("ui-disabled")),$e=!0,Ie(),$.mobile.changePage("#title",{transition:"slide",reverse:!0}),r=!1,Pe(),he=[me=pe=0,0],K=null,e.preventDefault()}),$(".again").click(function(e){$.mobile.changePage("#game",{transition:"pop",reverse:!0}),"2player"!==K&&"online"!==K&&1===me&&Re(),e.preventDefault()}),$(".bt_img").click(function(e){$("#b_image_input").click(),e.preventDefault()}),$(".bt_close").click(function(e){V="on"===oe.val(),ve&&localStorage.setItem("s_sound",oe.val()),Ie(),$.mobile.changePage("#title",{transition:"pop",reverse:!0}),e.preventDefault()}),$("#bt_reset").click(function(e){ve&&(localStorage.removeItem("easy_start"),localStorage.removeItem("easy_win"),localStorage.removeItem("easy_loose"),localStorage.removeItem("easy_draw"),localStorage.removeItem("medium_start"),localStorage.removeItem("medium_win"),localStorage.removeItem("medium_loose"),localStorage.removeItem("medium_draw"),localStorage.removeItem("hard_start"),localStorage.removeItem("hard_win"),localStorage.removeItem("hard_loose"),localStorage.removeItem("hard_draw"),localStorage.removeItem("online_Start"),localStorage.removeItem("online_win"),localStorage.removeItem("online_loose"),localStorage.removeItem("online_draw"),localStorage.removeItem("online_left"),Ee()),e.preventDefault()}),te.change(function(){var e;""!==(e=this.value).replace(/\s+/g,"")?(ve&&localStorage.setItem("s_name",e),Z=!0):(ve&&localStorage.removeItem("s_name"),Z=!1)}),le.change(function(){Ne(this.value.toLowerCase())}),le.keyup(function(){Ne(this.value.toLowerCase())}),e=0;e<i.length;e+=1)n[e]=document.getElementById(i[e]),c[e]=n[e].getContext("2d"),function(t){n[t].addEventListener("click",function(){var e;e=t,"online"===K?1===me&&"0"===O.role||0===me&&"1"===O.role||(N.emit("playsend",{to:O.opponent,col:e,round:_e}),xe(e)):xe(e)})}(e);ae.children().click(function(){o=this.className,localStorage.setItem("s_country",this.className),$("#bt_country").empty(),document.getElementById("bt_country").appendChild(this.cloneNode(!0)),$("#popupCountry").popup("close"),le.val(""),Ne("")}),jQuery.preLoadImages(["Images/red_on.png","Images/red_off.png","Images/blue_on.png","Images/blue_off.png","Images/title2eng.png"]),document.getElementById("b_image_input").addEventListener("change",Ae,!1),$("#popupSettings_col_b").find("label").attr("style","display:inline;"),Ie(),ne.delay(1500),ne.fadeOut(1e3),ne.queue(function(){(f=qe("theme"))&&"mi"===f?ne.attr("src","Images/title2_mi.png"):ne.attr("src","Images/title2eng.png"),$(this).fadeIn(1e3),$(this).dequeue()})},$(window).resize(function(){"popupSettings"===$.mobile.activePage.attr("id")&&l===$(window).width()||Ie()}),z=jQuery,Q=[],z.preLoadImages=function(e){var t=e.length-1;for(G=t;0<=G;G-=1)(U=document.createElement("img")).src=e[G],Q.push(U)},document.webL10n.ready(function(){f=qe("lang"),t=!0,f&&f!==document.webL10n.getLanguage()&&(document.webL10n.setLanguage(f),$("html").attr("lang",f),t=!1)}),document.addEventListener("localized",function(){if(t){$("html").attr("lang",document.webL10n.getLanguage().substr(0,2)),$("meta[name=description]").attr("content",document.webL10n.get("lb_desc")),$("link[rel=manifest]").attr("href","Manifest/appmanifest_"+document.webL10n.getLanguage().substr(0,2)+".json"),$("link[rel=canonical]").attr("href","https://grrd01.github.io/4inaRow/?lang="+document.webL10n.getLanguage().substr(0,2)),Ee();var e=ae.find("li").get();e.sort(function(e,t){var n=$(e).text(),o=$(t).text();return n<o?-1:o<n?1:0}),$.each(e,function(e,t){ae.append(t)})}t=!0})}();