/*
* grrd's 4 in a Row
* Copyright (c) 2012 Gerard Tyedmers, grrd@gmx.net
* Licensed under the MPL License
*/
!function(){"use strict";function a(a,b,c,d){N[b].beginPath(),N[b].arc(ga/2,a,ga/2*.85,0,2*Math.PI,!1),N[b].fillStyle=c,N[b].fill(),N[b].lineWidth=ga/20,N[b].strokeStyle=d,N[b].stroke()}function b(){var b,c,d;H=$(window).height(),I=$(window).width(),H>I?(ga=Math.min((I-50)/7,(H-140)/6),ha=Math.max(6*ga*.85,H-190),Fa.attr("style","width:100%;"),$(".li_port").attr("style","height:"+(H-I/3-130)/7+"px;"),$(".li_pad").attr("style","padding-top:"+(H-I/3-270)/14+"px;"),$("#page_landscape").attr("style","display:none;"),$("#page_portrait").attr("style","display:inline;"),$("#indicator_landscape_l").attr("style","display:none;"),$("#indicator_landscape_r").attr("style","display:none;"),$("#indicator_portrait").attr("style","display:block;"),$("#popupDialog_landscape").attr("style","display:none;"),$("#popupDialog_portrait").attr("style","display:block;"),$("#popupSettings_portrait").attr("style","display:block;"),$("#popupSettings_landscape").attr("style","display:none;"),$("#popupSettings_col_b").appendTo("#popupSettings_portrait"),$("#printMessage").attr("style","display:block;")):(ga=Math.min((I-140-60)/7,(H-20)/6),ha=Math.max(6*ga*.85,H-95),Fa.attr("style","width:"+.6*I+"px;"),$("#blank_space").attr("style","height:"+(H/4-I/20)+"px;"),$("#page_landscape").attr("style","display:inline;"),$("#page_portrait").attr("style","display:none;"),$("#indicator_landscape_l").attr("style","display:inline;"),$("#indicator_landscape_r").attr("style","display:inline;"),$("#indicator_portrait").attr("style","display:none;"),$("#popupDialog_landscape").attr("style","display:block;"),$("#popupDialog_portrait").attr("style","display:none;"),$("#popupSettings_portrait").attr("style","display:none;"),$("#popupSettings_landscape").attr("style","display:block;"),$("#popupSettings_col_b").appendTo("#popupSettings_landscape_b"),$("#printMessage").attr("style","display:inline;"));var e=Math.max((H-I/3)/7,0);for($(".a_land").attr("style","width:"+(I/5-8)+"px;padding-bottom:"+e/2+"px;"),$(".img_land").attr("style","padding-top:"+e+"px;padding-bottom:"+e/2+"px;width: 100%;min-width: 40px;max-width: 108px;"),b=0;b<L.length;b+=1)document.getElementById(L[b]).width=ga,document.getElementById(L[b]).height=ha;for(c=0;c<O[0].length&&void 0!==N[c];c+=1)for(b=0;b<O.length;b+=1)d=N[c].createLinearGradient(0,.9*(O.length-b-1)*ga,.7*ga,.9*(O.length-b-1)*ga+.7*ga),d.addColorStop(0,"black"),d.addColorStop(1,"grey"),N[c].beginPath(),N[c].arc(ga/2,(O.length-b-.5)*ga*.85,ga/2*.7,0,2*Math.PI,!1),N[c].lineWidth=ga/10,N[c].strokeStyle=d,N[c].stroke();for(c=0;c<O[0].length&&void 0!==N[c];c+=1){for(N[c].save(),N[c].beginPath(),b=0;b<O.length;b+=1)N[c].arc(ga/2,(O.length-b-.5)*ga*.85,ga/2*.7,0,2*Math.PI,!1);N[c].clip(),N[c].clearRect(0,0,ga,ha)}for(b=0;b<O.length;b+=1)for(c=0;c<O[b].length;c+=1)void 0!==O[b][c]&&a((O.length-b-.5)*ga*.85,c,La[O[b][c]],Ma[O[b][c]]);K&&(fa=fa/ea*(O.length-Z-.5)*ga*.85,ea=(O.length-Z-.5)*ga*.85)}function c(){var a,c;for(Va=0,Ua=null,a=0;a<O.length;a+=1)for(c=0;c<O[a].length;c+=1)O[a][c]=void 0,0===a&&N[c].clearRect(0,0,ga,ha);b()}function d(){$(".P1light").attr("src",Pa[Oa]),$(".P2light").attr("src",Qa[1-Oa])}function e(){var a,b;Ya?(a=parseInt(localStorage.getItem(za+"_win")||0),b=parseInt(localStorage.getItem(za+"_loose")||0)):(a=0,b=0),"online"===za?(ia=Math.max(a+b,ra+sa,1),$(".P"+(1+parseInt(ua.role))+".win").width(100/ia*a+"%"),$(".P"+(1+parseInt(ua.role))+".loose").width(100/ia*b+"%"),$(".P"+(2-parseInt(ua.role))+".win").width(100/ia*ra+"%"),$(".P"+(2-parseInt(ua.role))+".loose").width(100/ia*sa+"%")):("2player"===za&&(a=Sa[0],b=Sa[1]),ia=Math.max(a+b,1),$(".P1.win").width(100/ia*a+"%"),$(".P1.loose").width(100/ia*b+"%"),$(".P2.win").width(100/ia*b+"%"),$(".P2.loose").width(100/ia*a+"%"))}function f(a){var b,c;Ya&&(za&&a&&(b=za+"_"+a,c=parseInt(localStorage.getItem(b)||0)+1,localStorage.setItem(b,c)),la=localStorage.getItem("easy_win")||0,ma=localStorage.getItem("easy_loose")||0,na=localStorage.getItem("medium_win")||0,oa=localStorage.getItem("medium_loose")||0,pa=localStorage.getItem("hard_win")||0,qa=localStorage.getItem("hard_loose")||0,ja=localStorage.getItem("online_win")||0,ka=localStorage.getItem("online_loose")||0,ia=Math.max(la,ma,na,oa,pa,qa,ja,ka,1),document.getElementById("easy_win").innerHTML=document.webL10n.get("lb_won")+" "+la,document.getElementById("easy_loose").innerHTML=document.webL10n.get("lb_lost")+" "+ma,document.getElementById("medium_win").innerHTML=document.webL10n.get("lb_won")+" "+na,document.getElementById("medium_loose").innerHTML=document.webL10n.get("lb_lost")+" "+oa,document.getElementById("hard_win").innerHTML=document.webL10n.get("lb_won")+" "+pa,document.getElementById("hard_loose").innerHTML=document.webL10n.get("lb_lost")+" "+qa,document.getElementById("online_win").innerHTML=document.webL10n.get("lb_won")+" "+ja,document.getElementById("online_loose").innerHTML=document.webL10n.get("lb_lost")+" "+ka,document.getElementById("easy_win").style.width=100/ia*la+"%",document.getElementById("easy_loose").style.width=100/ia*ma+"%",document.getElementById("medium_win").style.width=100/ia*na+"%",document.getElementById("medium_loose").style.width=100/ia*oa+"%",document.getElementById("hard_win").style.width=100/ia*pa+"%",document.getElementById("hard_loose").style.width=100/ia*qa+"%",document.getElementById("online_win").style.width=100/ia*ja+"%",document.getElementById("online_loose").style.width=100/ia*ka+"%")}function g(){Ya&&(localStorage.removeItem("easy_start"),localStorage.removeItem("easy_win"),localStorage.removeItem("easy_loose"),localStorage.removeItem("easy_draw"),localStorage.removeItem("medium_start"),localStorage.removeItem("medium_win"),localStorage.removeItem("medium_loose"),localStorage.removeItem("medium_draw"),localStorage.removeItem("hard_start"),localStorage.removeItem("hard_win"),localStorage.removeItem("hard_loose"),localStorage.removeItem("hard_draw"),localStorage.removeItem("online_Start"),localStorage.removeItem("online_win"),localStorage.removeItem("online_loose"),localStorage.removeItem("online_draw"),localStorage.removeItem("online_left"),f())}function h(){za="2player",Ba?$(".P1icon").attr("src",Da.attr("src")):$(".P1icon").attr("src","Images/player.svg"),V=Ca?Ea.val():document.webL10n.get("lb_player1"),T?($("p.P1country").html(document.getElementById("l_country").getElementsByClassName(T)[0].innerHTML),$(".P1country").attr("class","P1country "+T),$("div.P1country").addClass("flag_left")):($("p.P1country").html(" "),$(".P1country").attr("class","P1country"),$("div.P1country").addClass("flag_left")),W=document.webL10n.get("lb_player2"),$(".P1name").html(V),$(".P2name").html(W),$(".P2icon").attr("src","Images/player.svg"),$(".P2country").attr("class","P2country"),$("p.P2country").html(" "),$("div.P2country").addClass("flag_right"),d(),e(),Wa=!1,$.mobile.changePage("#game",{transition:"slide"})}function i(a,b){Wa||(b+2e3>Date.now()&&K?window.requestAnimFrame(function(){i(a,b)}):(Ra+=1,$("#printMessage").html(a),1===Ra?$("#printGames").html(Ra+" "+document.webL10n.get("lb_game")):$("#printGames").html(Ra+" "+document.webL10n.get("lb_games")),$("#printScore1a").html(V),$("#printScore2a").html(W),$("#printScore1b").html(Sa[0]),$("#printScore2b").html(Sa[1]),$.mobile.changePage("#popupDialog",{transition:"pop",role:"dialog"}),c(),Oa=Ra%2!==0?1:0,d(),K=!1))}function j(b,c,d,e){var f;if(!Wa)if(6>d&&e+250<Date.now()&&K){for(d+=1,e=Date.now(),f=0;4>f;f+=1)d%2!==0?a((O.length-b[f]-.5)*ga*.85,c[f],Na[Oa],"white"):a((O.length-b[f]-.5)*ga*.85,c[f],La[Oa],"white");window.requestAnimFrame(function(){j(b,c,d,e)})}else 6>d&&K&&window.requestAnimFrame(function(){j(b,c,d,e)})}function k(){K=!0;var a=xa.slice(),b=ya.slice();j(a,b,0,Date.now())}function l(a,b,c,d,e,f){var g;if(a+3*c<O.length&&b+3*d<O[a].length&&a+3*c>=0&&b+3*d>=0)for(g=0;4>g;g+=1)O[a+g*c][b+g*d]===e?(xa[g]=a+g*c,ya[g]=b+g*d,3===g&&(ba=!0,f&&k(),g=5)):g=5}function m(a,b){for(ba=!1,Z=0;Z<O.length;Z+=1)for(Y=0;Y<O[Z].length;Y+=1)l(Z,Y,1,0,a,b),l(Z,Y,0,1,a,b),l(Z,Y,1,1,a,b),l(Z,Y,1,-1,a,b);for(ca=!1,Y=0;Y<O[0].length;Y+=1)void 0===O[O.length-1][Y]&&(ca=!0)}function n(b,c,g){var h,j,k,l;K&&(h=new Date,j=h.getTime(),k=j-b,l=ha*k/1e3,ea>c?(c=Math.min(ea,c+l),b=j,N[g].clearRect(0,0,ga,ea+ga/2*.85),a(c,g,La[Oa],Ma[Oa]),window.requestAnimFrame(function(){n(b,c,g)})):(Aa&&document.getElementById("click_sound").play(),K=!1,m(Oa,!0),ba?(Sa[Oa]=Sa[Oa]+1,("easy"===za||"medium"===za||"hard"===za)&&f(0===Oa?"win":"loose"),"online"===za&&(0===Oa&&"0"===ua.role||1===Oa&&"1"===ua.role?(sa+=1,f("win")):(ra+=1,f("loose"))),e(),Aa&&document.getElementById("ding_sound").play(),0===Oa?i(V+" "+document.webL10n.get("lb_win"),Date.now()):i(W+" "+document.webL10n.get("lb_win"),Date.now())):ca?(Oa=1-Oa,d(),"2player"!==za&&"online"!==za&&1===Oa&&z()):(f("draw"),i(document.webL10n.get("lb_draw"),Date.now()))))}function o(a){var b,c;if(!(Xa&&(Xa=!1,"online"===za&&(0===Oa&&"0"===ua.role||1===Oa&&"1"===ua.role))||K))for(Va+=1,Z=0,ea=0;Z<O.length&&0===ea;){if(void 0===O[Z][a]){K=!0,O[Z][a]=Oa,ea=(O.length-Z-.5)*ga*.85,b=new Date,c=b.getTime(),fa=-30,n(c,fa,a);break}Z+=1}}function p(){$.mobile.changePage("#popupOnline",{transition:"pop",role:"dialog"}),$(".bt_online").addClass("ui-disabled"),ta=io.connect("https://grrd.a2hosted.com:49152",{forceNew:!0}),ta.heartbeatTimeout=2e4,ta.on("connect",function(){}),ta.on("startgame",function(a){ua=a,ra=0,sa=0,ua.id!==va&&(U=Ba?Da.attr("src"):null,ta.emit("usersend",{to:ua.opponent,name:Ea.val(),pic:U,country:T,win:ja,loose:ka}),va=ua.id,Wa=!1,null!==za&&$.mobile.changePage("#title",{transition:"slide",reverse:!0}),K=!1,c(),Ra=0,Oa=0,Sa=[0,0],za="online",d(),e(),"0"===ua.role?(Ba?$(".P1icon").attr("src",Da.attr("src")):$(".P1icon").attr("src","Images/player.svg"),V=Ca?Ea.val():document.webL10n.get("lb_player1"),T?($("p.P1country").html(document.getElementById("l_country").getElementsByClassName(T)[0].innerHTML),$(".P1country").attr("class","P1country "+T),$("div.P1country").addClass("flag_left")):($("p.P1country").html(" "),$(".P1country").attr("class","P1country"),$("div.P1country").addClass("flag_left")),$(".P2icon").attr("src","Images/online.svg"),W=document.webL10n.get("bt_online")):($(".P1icon").attr("src","Images/online.svg"),V=document.webL10n.get("bt_online"),Ba?$(".P2icon").attr("src",Da.attr("src")):$(".P2icon").attr("src","Images/player.svg"),W=Ca?Ea.val():document.webL10n.get("lb_player1"),T?($("p.P2country").html(document.getElementById("l_country").getElementsByClassName(T)[0].innerHTML),$(".P2country").attr("class","P2country "+T),$("div.P2country").addClass("flag_right")):($("p.P2country").html(" "),$(".P2country").attr("class","P2country"),$("div.P2country").addClass("flag_right"))),$(".P1name").html(V),$(".P2name").html(W),$.mobile.changePage("#game",{transition:"slide"}))}),ta.on("playget",function(a){Va===a.round&&Ua!==a.round&&(Ua=a.round,Xa=!0,o(a.col))}),ta.on("userget",function(a){ra=parseInt(a.win),sa=parseInt(a.loose),ia=Math.max(ja,ka,ra,sa,1),"0"===ua.role?(null!==a.pic&&$(".P2icon").attr("src",a.pic),a.name.length>0&&(W=a.name,$(".P2name").html(W)),a.country?($("p.P2country").html(document.getElementById("l_country").getElementsByClassName(a.country)[0].innerHTML),$(".P2country").attr("class","P2country "+a.country),$("div.P2country").addClass("flag_right")):($("p.P2country").html(" "),$(".P2country").attr("class","P2country"),$("div.P2country").addClass("flag_right"))):(null!==a.pic&&$(".P1icon").attr("src",a.pic),a.name.length>0&&(V=a.name,$(".P1name").html(V)),a.country?($("p.P1country").html(document.getElementById("l_country").getElementsByClassName(a.country)[0].innerHTML),$(".P1country").attr("class","P1country "+a.country),$("div.P1country").addClass("flag_left")):($("p.P1country").html(" "),$(".P1country").attr("class","P1country"),$("div.P1country").addClass("flag_left"))),e()}),ta.on("quit",function(){ua.id!==wa&&(wa=ua.id,Wa=!0,$.mobile.changePage("#popupLeft",{transition:"pop",role:"dialog"}))})}function q(){Ba?$(".P1icon").attr("src",Da.attr("src")):$(".P1icon").attr("src","Images/player.svg"),V=Ca?Ea.val():document.webL10n.get("lb_player"),T?($("p.P1country").html(document.getElementById("l_country").getElementsByClassName(T)[0].innerHTML),$(".P1country").attr("class","P1country "+T),$("div.P1country").addClass("flag_left")):($("p.P1country").html(" "),$(".P1country").attr("class","P1country"),$("div.P1country").addClass("flag_left")),W=document.webL10n.get("lb_computer"),$(".P1name").html(V),$(".P2name").html(W),$(".P2icon").attr("src","Images/computer.svg"),$("p.P2country").html(" "),$(".P2country").attr("class","P2country"),$("div.P2country").addClass("flag_right"),e(),d(),Wa=!1,$.mobile.changePage("#game",{transition:"slide"})}function r(){za="easy",q()}function s(){za="medium",q()}function t(){za="hard",q()}function u(){"online"===za&&(ta.disconnect(),$(".bt_online").removeClass("ui-disabled")),Wa=!0,b(),$.mobile.changePage("#title",{transition:"slide",reverse:!0}),K=!1,c(),Ra=0,Oa=0,Sa=[0,0],za=null}function v(){Aa="on"===Ga.val(),Ya&&localStorage.setItem("s_sound",Ga.val()),b(),$.mobile.changePage("#title",{transition:"pop",reverse:!0})}function w(a){"online"===za?1===Oa&&"0"===ua.role||0===Oa&&"1"===ua.role||(ta.emit("playsend",{to:ua.opponent,col:a,round:Va}),o(a)):o(a)}function x(a,b,c){var d,e;for(P=0,Q=0,R=0,d=c-3;c>=d;d+=1)if(d>=0&&d+3<O[0].length){for(Ta=!0,S=0,e=0;3>=e;e+=1)void 0!==O[b][d+e]&&(O[b][d+e]===a?S+=1:Ta=!1);Ta&&(P+=1,Q+=S,S>R&&(R=S))}for(d=b+3;d>=b;d-=1)if(d-3>=0&&d<O.length){for(Ta=!0,S=0,e=0;3>=e;e+=1)void 0!==O[d-e][c]&&(O[d-e][c]===a?S+=1:Ta=!1);Ta&&(P+=1,Q+=S,S>R&&(R=S))}for(d=3;d>=0;d-=1)if(c-d>=0&&c-d+3<O[0].length&&b-d>=0&&b-d+3<O.length){for(Ta=!0,S=0,e=0;3>=e;e+=1)void 0!==O[b-d+e][c-d+e]&&(O[b-d+e][c-d+e]===a?S+=1:Ta=!1);Ta&&(P+=1,Q+=S,S>R&&(R=S))}for(d=3;d>=0;d-=1)if(c-d>=0&&c-d+3<O[0].length&&b+d<O.length&&b+d-3>=0){for(Ta=!0,S=0,e=0;3>=e;e+=1)void 0!==O[b+d-e][c-d+e]&&(O[b+d-e][c-d+e]===a?S+=1:Ta=!1);Ta&&(P+=1,Q+=S,S>R&&(R=S))}}function y(a,b){return a-b}function z(){var a;for(Ja=[],da=!1,_=0;_<O[0].length;_+=1)for(Ja[_]=0,aa=0;aa<O.length;aa+=1)if(void 0===O[aa][_]){O[aa][_]=Oa,x(Oa,aa,_),Ja[_]=1e4*R+100*P+Q+2,O[aa][_]=void 0;break}for(Ka[0]=0,a=0;a<Ja.length;a+=1)Ja[a]>Ka[0]&&(Ka[0]=Ja[a]);for(Oa=1-Oa,_=0;_<O[0].length;_+=1)for(aa=0;aa<O.length;aa+=1)if(void 0===O[aa][_]){O[aa][_]=Oa,x(Oa,aa,_),1e4*R+100*P+Q+2>Ka[0]&&(Ja[_]=1e4*R+100*P+Q+2),O[aa][_]=void 0;break}for(Oa=1-Oa,Oa=1-Oa,_=0;_<O[0].length;_+=1){for(aa=0;aa<O.length-1;aa+=1)if(void 0===O[aa][_]){O[aa+1][_]=Oa,m(Oa,da),O[aa+1][_]=void 0;break}ba&&(Ja[_]=1,ba=!1)}for(Oa=1-Oa,Oa=1-Oa,_=0;_<O[0].length;_+=1){for(aa=0;aa<O.length;aa+=1)if(void 0===O[aa][_]){O[aa][_]=Oa,m(Oa,da),O[aa][_]=void 0;break}ba&&(Ja[_]=5e4,ba=!1)}for(Oa=1-Oa,_=0;_<O[0].length;_+=1){for(aa=0;aa<O.length;aa+=1)if(void 0===O[aa][_]){O[aa][_]=Oa,m(Oa,da),O[aa][_]=void 0;break}ba&&(Ja[_]=6e4,ba=!1)}if(Ka=Ja.slice(),Ka.sort(y),Ka.reverse(),Y=Math.round(6*Math.random()),"hard"===za)for(;Ja[Y]!==Ka[0];)Y=Math.round(6*Math.random());if("medium"===za)for(;Ja[Y]<Ka[1]||0===Ja[Y];)Y=Math.round(6*Math.random());if("easy"===za)for(;Ja[Y]<Ka[2]||0===Ja[Y];)Y=Math.round(6*Math.random());o(Y)}function A(){$.mobile.changePage("#game",{transition:"pop",reverse:!0}),"2player"!==za&&"online"!==za&&1===Oa&&z()}function B(a){a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var b="[\\?&]"+a+"=([^&#]*)",c=new RegExp(b),d=c.exec(window.location.href);return null!==d?d[1]:!1}function C(a){var b=new FileReader,c=document.createElement("canvas"),d=null,e=new Image,f=67,g=71,h={Orientation:void 0};c.id="hiddenCanvas",c.width=f,c.height=g,c.style.visibility="hidden",document.body.appendChild(c),d=c.getContext("2d"),a.target.files[0].type.match("image.*")?b.readAsDataURL(a.target.files[0]):alert("File is not an image"),b.onload=function(){var b=this.result;EXIF.getData(a.target.files[0],function(){h.Orientation=EXIF.getTag(this,"Orientation"),e.src=b})},e.onload=function(){var a=0,b=0;0===this.width||0===this.height?alert("Image is empty"):((5===h.Orientation||6===h.Orientation)&&(d.rotate(90*Math.PI/180),b=-1*f,f=71,g=67),(3===h.Orientation||4===h.Orientation)&&(d.rotate(180*Math.PI/180),b=-1*f-4,a=-1*g+4),(7===h.Orientation||8===h.Orientation)&&(d.rotate(270*Math.PI/180),a=-1*g,f=71,g=67),d.clearRect(0,0,f,g),d.drawImage(e,0,0,this.width,this.height,a,b,f,g),Da.attr("src",c.toDataURL("image/jpeg")),$("#inputImage_l").attr("src",c.toDataURL("image/jpeg")),Ya&&localStorage.setItem("s_image",c.toDataURL("image/jpeg")),Ba=!0)}}function D(a){""!==a.replace(/\s+/g,"")?(Ya&&localStorage.setItem("s_name",a),Ca=!0):(Ya&&localStorage.removeItem("s_name"),Ca=!1)}function E(a){var b=Ha.find("li");b.each(function(b,c){var d=$(c);d[0].innerHTML.toLowerCase().indexOf(a)>-1||0===a.length?d.show():d.hide()})}function F(){$("#b_image_input").click()}window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){window.setTimeout(a,1e3/60)}}();var G,H,I,J=!1,K=!1,L=["col0","col1","col2","col3","col4","col5","col6"],M=[],N=[],O=[];for(G=0;6>G;G+=1)O[G]=[],O[G][6]=void 0;var P,Q,R,S,T,U,V,W,X,Y,Z,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra,sa,ta,ua,va,wa,xa=[],ya=[],za=null,Aa=!0,Ba=!1,Ca=!1,Da=$("#inputImage"),Ea=$("#inputName"),Fa=$("#img_title"),Ga=$("#b_sound"),Ha=$("#l_country"),Ia=$("#txt_search"),Ja=[],Ka=[],La=["#ff0080","#6969EE"],Ma=["#D6016B","#5A5ACE"],Na=["#FD6BB4","#9393EF"],Oa=0,Pa=["Images/red_on.png","Images/red_off.png"],Qa=["Images/blue_on.png","Images/blue_off.png"],Ra=0,Sa=[0,0],Ta=Boolean(!1),Ua=null,Va=0,Wa=!1,Xa=!1,Ya=function(){var a="modernizr";try{return localStorage.setItem(a,a),localStorage.removeItem(a),!0}catch(b){return!1}}();"serviceWorker"in navigator&&window.addEventListener("load",function(){navigator.serviceWorker.register("sw.js").then(function(a){console.log("ServiceWorker registration successful with scope: ",a.scope)},function(a){console.log("ServiceWorker registration failed: ",a)})}),navigator.onLine||$(".bt_online").addClass("ui-disabled"),window.onload=function(){var a;if(Ya&&null!==localStorage.getItem("s_sound")?Ga.val(localStorage.getItem("s_sound")):Ga.val("on"),Aa="on"===Ga.val(),Ya&&null!==localStorage.getItem("s_image")&&(Da.attr("src",localStorage.getItem("s_image")),$("#inputImage_l").attr("src",localStorage.getItem("s_image")),Ba=!0),Ya&&null!==localStorage.getItem("s_name")&&(Ea.val(localStorage.getItem("s_name")),""!==localStorage.getItem("s_name").replace(/\s+/g,"")&&(Ca=!0)),Ya&&null!==localStorage.getItem("s_country")){$("#bt_country").empty(),T=localStorage.getItem("s_country");var c=document.getElementsByClassName(T);document.getElementById("bt_country").appendChild(c[0].cloneNode(!0))}for(X=B("theme"),$(".bt_play").click(function(a){h(),a.preventDefault()}),$(".bt_online").click(function(a){p(),a.preventDefault()}),$(".bt_easy").click(function(a){r(),a.preventDefault()}),$(".bt_med").click(function(a){s(),a.preventDefault()}),$(".bt_hard").click(function(a){t(),a.preventDefault()}),$(".back").click(function(a){u(),a.preventDefault()}),$(".again").click(function(a){A(),a.preventDefault()}),$(".bt_img").click(function(a){F(),a.preventDefault()}),$(".bt_close").click(function(a){v(),a.preventDefault()}),$("#bt_reset").click(function(a){g(),a.preventDefault()}),Ea.change(function(){D(this.value)}),Ia.change(function(){E(this.value.toLowerCase())}),Ia.keyup(function(){E(this.value.toLowerCase())}),a=0;a<L.length;a+=1)M[a]=document.getElementById(L[a]),N[a]=M[a].getContext("2d"),function(a){M[a].addEventListener("click",function(){w(a)})}(a);Ha.children().click(function(){T=this.className,localStorage.setItem("s_country",this.className),$("#bt_country").empty(),document.getElementById("bt_country").appendChild(this.cloneNode(!0)),$("#popupCountry").popup("close"),Ia.val(""),E("")}),jQuery.preLoadImages(["Images/red_on.png","Images/red_off.png","Images/blue_on.png","Images/blue_off.png","Images/title2eng.png"]),document.getElementById("b_image_input").addEventListener("change",C,!1),$("#popupSettings_col_b").find("label").attr("style","display:inline;"),b(),Fa.delay(1500),Fa.fadeOut(1e3),Fa.queue(function(){X=B("theme"),X&&"mi"===X?Fa.attr("src","Images/title2_mi.png"):Fa.attr("src","Images/title2eng.png"),$(this).fadeIn(1e3),$(this).dequeue()})},$(window).resize(function(){("popupSettings"!==$.mobile.activePage.attr("id")||I!==$(window).width())&&b()}),function(a){var b,c,d=[];a.preLoadImages=function(a){var e=a.length-1;for(c=e;c>=0;c-=1)b=document.createElement("img"),b.src=a[c],d.push(b)}}(jQuery),document.webL10n.ready(function(){X=B("lang"),J=!0,X&&X!==document.webL10n.getLanguage()&&(document.webL10n.setLanguage(X),$("html").attr("lang",X),J=!1)}),document.addEventListener("localized",function(){if(J){$("html").attr("lang",document.webL10n.getLanguage().substr(0,2)),$("meta[name=description]").attr("content",document.webL10n.get("lb_desc")),$("link[rel=manifest]").attr("href","Manifest/appmanifest_"+document.webL10n.getLanguage().substr(0,2)+".json"),f();var a=Ha.find("li").get();a.sort(function(a,b){var c=$(a).text(),d=$(b).text();return d>c?-1:c>d?1:0}),$.each(a,function(a,b){Ha.append(b)})}J=!0})}();